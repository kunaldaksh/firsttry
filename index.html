<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModiJiUrl.com</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #f4f4f9; padding: 80px 0; }
        .header { background: #3f51b5; color: white; padding: 20px; font-size: 28px; position: fixed; top: 0; width: 100%; }
        .container { text-align: center; margin-top: 80px; }
        .message, .timer { margin-bottom: 20px; }
        .wait-btn { opacity: 0.6; cursor: not-allowed; }
        .ready-link { display: none; }
    </style>
</head>
<body>

    <div class="header">ModiJiUrl.com</div>
    <div class="container">
        <div class="message">Your link is almost ready.</div>
        <div class="timer" id="timer">10 Seconds</div>
        <button class="wait-btn" disabled>PLEASE WAIT...</button>
        <div class="ready-link" id="ready-link">
            <p>Your link is ready: <a id="link" href="#" target="_blank">Click here</a></p>
        </div>
    </div>

    <script>
        let timeLeft = 10;
        const timerElement = document.getElementById('timer');
        const readyLink = document.getElementById('ready-link');
        const linkElement = document.getElementById('link');
        
        // Unique ID is extracted from the URL (last part of the URL path)
        const uniqueId = window.location.pathname.split('/').pop();

        // Fetch the original link from the Replit Flask backend
        async function fetchLink() {
            try {
                // Use your Replit domain here (replace 'your-replit-app' with your actual replit app name)
                const response = await fetch(`https://kunaldaksh.github.io/firsttry/get-link/${uniqueId}`);
                const data = await response.json();
                
                if (data.link) {
                    linkElement.href = data.link;  // Set the original link in the anchor tag
                } else {
                    linkElement.textContent = "Error: Link not found.";
                }
            } catch (error) {
                console.error("Error fetching link:", error);
                linkElement.textContent = "Error fetching link.";
            }
        }

        // Countdown timer function
        const countdown = setInterval(() => {
            if (timeLeft <= 0) {
                clearInterval(countdown);
                timerElement.textContent = "0 Seconds";
                readyLink.style.display = "block";  // Show the ready link
                fetchLink();  // Fetch the original link when the timer ends
            } else {
                timerElement.textContent = `${timeLeft} Seconds`;
            }
            timeLeft--;
        }, 1000);
    </script>

</body>
</html>
